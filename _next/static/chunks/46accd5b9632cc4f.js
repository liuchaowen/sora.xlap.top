(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),s=e.i(71645);function l(){let[e,l]=(0,s.useState)("text-to-video"),[r,a]=(0,s.useState)(""),[i,n]=(0,s.useState)([]),[o,c]=(0,s.useState)("sora-2"),[d,u]=(0,s.useState)("16:9"),[h,x]=(0,s.useState)(!1),[m,g]=(0,s.useState)("10"),[p,b]=(0,s.useState)(!1),[j,v]=(0,s.useState)(null),[f,w]=(0,s.useState)(null),[N,y]=(0,s.useState)(null),[k,S]=(0,s.useState)(null),[_,C]=(0,s.useState)(""),[I,E]=(0,s.useState)(""),[A,R]=(0,s.useState)(null),P=(0,s.useRef)(null),L=(0,s.useRef)(null);(0,s.useEffect)(()=>()=>{L.current&&clearInterval(L.current)},[]);let T=(0,s.useCallback)(e=>51===e.length&&e.startsWith("sk-"),[]);(0,s.useEffect)(()=>{let e=localStorage.getItem("current_task_id");e&&(y(e),b(!0),O(e));let t=localStorage.getItem("x_api_key");t&&(E(t),R(T(t)))},[T]);let U=async e=>{try{let t=localStorage.getItem("x_api_key");if(!t)throw Error("请先设置有效的X Key");let s=await fetch("".concat("https://api.xlap.top","/v2/videos/generations/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok)throw Error("查询任务状态失败: ".concat(s.status));let l=await s.json();switch(S(l),C((e=>{if(!e)return"";if(e.includes("%"))return e;let t=parseFloat(e);return isNaN(t)?e:"".concat(t,"%")})(l.progress)),l.status){case"SUCCESS":l.data.output&&(v(l.data.output),b(!1),L.current&&(clearInterval(L.current),L.current=null));break;case"FAILURE":w(l.fail_reason||"视频生成失败"),b(!1),L.current&&(clearInterval(L.current),L.current=null)}}catch(e){console.error("Poll task status error:",e),w(e instanceof Error?e.message:"查询任务状态时发生错误")}},O=e=>{L.current&&clearInterval(L.current),U(e),L.current=setInterval(()=>{U(e)},1e4)},B=async()=>{let t=localStorage.getItem("x_api_key");if(!t)return void w("请先设置有效的X Key");if(!r.trim())return void w("请输入提示词");if("image-to-video"===e&&0===i.length)return void w("请上传至少一张图片");b(!0),w(null),v(null),S(null),C("");try{let s={prompt:r.trim(),model:o,aspect_ratio:d,duration:m,hd:h,images:[]};"image-to-video"===e&&(s.images=i.map(e=>{let t=e.indexOf(",");return -1!==t?e.substring(t+1):e})),"sora-2-pro"===o&&h&&(s.hd=h);let l=await fetch("".concat("https://api.xlap.top","/v2/videos/generations"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(s)});if(!l.ok){let e=await l.text();throw console.error("API Error:",l.status,e),Error("API请求失败: ".concat(l.status," - ").concat(e))}let a=await l.json();if(a.task_id)y(a.task_id),localStorage.setItem("current_task_id",a.task_id),O(a.task_id);else throw Error("未获取到任务ID")}catch(e){console.error("Video generation error:",e),w(e instanceof Error?e.message:"生成视频时发生错误"),b(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen relative overflow-hidden",children:[(0,t.jsxs)("div",{className:"fixed inset-0 z-0",children:[(0,t.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover",children:(0,t.jsx)("source",{src:"https://xlaptop.oss-cn-hongkong.aliyuncs.com/bg.mp4",type:"video/mp4"})}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50"})]}),(0,t.jsx)("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-4xl bg-white/10 backdrop-blur-lg rounded-2xl p-8 shadow-2xl",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-white mb-4",children:"Sora2 AI 视频生成"}),(0,t.jsx)("p",{className:"text-white/80 text-lg",children:"使用最先进的 AI 技术，从文本或图片生成高质量视频"}),(0,t.jsxs)("p",{className:"text-white/80 text-lg",children:[(0,t.jsx)("b",{children:"标准￥0.15"})," ",(0,t.jsx)("small",{children:"/次"}),"， ",(0,t.jsx)("b",{children:"Pro模型￥2.55"})," ",(0,t.jsx)("small",{children:"/次"}),"，不成功自动补偿"]})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsxs)("div",{className:"bg-white/20 rounded-lg p-1 flex",children:[(0,t.jsx)("button",{onClick:()=>l("text-to-video"),className:"px-6 py-3 rounded-md font-medium transition-all ".concat("text-to-video"===e?"bg-white text-gray-900 shadow-lg":"text-white hover:bg-white/10"),children:"文生视频"}),(0,t.jsx)("button",{onClick:()=>l("image-to-video"),className:"px-6 py-3 rounded-md font-medium transition-all ".concat("image-to-video"===e?"bg-white text-gray-900 shadow-lg":"text-white hover:bg-white/10"),children:"图生视频"})]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"w-full flex justify-between items-center mb-2",children:(0,t.jsx)("div",{className:"w-full flex items-center space-x-2",children:(0,t.jsxs)("div",{className:"w-full relative",children:[(0,t.jsx)("input",{type:"text",value:I,onChange:e=>{E(e.target.value)},onBlur:()=>{if(!I)return void R(null);let e=T(I);R(e),e&&localStorage.setItem("x_api_key",I)},placeholder:"输入X Key",className:"w-full px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,t.jsxs)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center",children:[!0===A&&(0,t.jsx)("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),!1===A&&(0,t.jsx)("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),I&&(0,t.jsx)("button",{onClick:()=>{E(""),R(null),localStorage.removeItem("x_api_key")},className:"ml-2 text-white/70 hover:text-white",title:"清除X Key",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),!I&&(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("a",{href:"https://api.xlap.top",target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-white hover:text-pink-300",title:"获取X Key",children:"获取"})}),(0,t.jsxs)("div",{className:"relative ml-2 group",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full border border-white flex items-center justify-center text-white  hover:text-pink-300 hover:border-pink-300 cursor-help",children:(0,t.jsx)("span",{className:"text-xs font-bold",children:"?"})}),(0,t.jsxs)("div",{className:"absolute z-50 hidden group-hover:block w-68 bg-gray-900 text-white text-sm rounded-lg p-3 shadow-lg -right-2 top-6",children:[(0,t.jsx)("div",{className:"absolute -top-2 right-3 w-4 h-4 bg-gray-900 transform rotate-45"}),(0,t.jsxs)("ol",{className:"space-y-2 list-decimal list-inside",children:[(0,t.jsx)("li",{children:"注册登录 X API平台"}),(0,t.jsx)("li",{children:"创建令牌，自定义名称，default分组"}),(0,t.jsx)("li",{children:"充值余额，并复制至左侧"})]})]})]})]})]})})}),(0,t.jsx)("textarea",{value:r,onChange:e=>a(e.target.value),placeholder:"描述您想要生成的视频内容...",className:"w-full h-32 px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),"image-to-video"===e&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-white font-medium mb-2",children:"上传图片 *"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("button",{onClick:()=>{var e;return null==(e=P.current)?void 0:e.click()},className:"w-full py-3 px-4 bg-white/20 border-2 border-dashed border-white/30 rounded-lg text-white hover:bg-white/30 transition-colors",children:"点击上传图片"}),(0,t.jsx)("input",{ref:P,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=e.target.files;t&&Promise.all(Array.from(t).map(e=>new Promise(t=>{let s=new FileReader;s.onload=e=>{var s;return t(null==(s=e.target)?void 0:s.result)},s.readAsDataURL(e)}))).then(e=>{n(t=>[...t,...e])})},className:"hidden"}),i.length>0&&(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:i.map((e,s)=>(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("img",{src:e,alt:"上传的图片 ".concat(s+1),className:"w-full h-24 object-cover rounded-lg"}),(0,t.jsx)("button",{onClick:()=>{n(e=>e.filter((e,t)=>t!==s))},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm opacity-0 group-hover:opacity-100 transition-opacity",children:"×"})]},s))})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-white font-medium mb-2",children:"AI 模型"}),(0,t.jsxs)("select",{value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"sora-2",className:"text-gray-900",children:"Sora-2 (标准)"}),(0,t.jsx)("option",{value:"sora-2-pro",className:"text-gray-900",children:"Sora-2-Pro (支持高清和15秒)"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-white font-medium mb-2",children:"视频比例"}),(0,t.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"16:9",className:"text-gray-900",children:"16:9 横屏"}),(0,t.jsx)("option",{value:"9:16",className:"text-gray-900",children:"9:16 竖屏"})]})]})]}),"sora-2-pro"===o&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-white font-medium mb-2",children:"视频时长"}),(0,t.jsxs)("select",{value:m,onChange:e=>g(e.target.value),className:"w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"10",className:"text-gray-900",children:"10秒"}),(0,t.jsx)("option",{value:"15",className:"text-gray-900",children:"15秒"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-white font-medium mb-2",children:"清晰度"}),(0,t.jsxs)("label",{className:"flex w-full py-3 text-white cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:h,onChange:e=>x(e.target.checked),className:"mr-3 w-5 h-5 text-blue-600 bg-white/20 border-white/30 rounded focus:ring-blue-500"}),"高清模式 (较慢)"]})]})]}),f&&(0,t.jsx)("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4",children:(0,t.jsx)("p",{className:"text-red-200",children:f})}),p&&(0,t.jsx)("div",{className:"bg-blue-500/20 border border-blue-500/50 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"text-blue-200",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"视频生成说明"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"模型："}),"sora-2"===o?"Sora-2 (标准)":"Sora-2-Pro (专业)"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"预计生成时间："}),"sora-2"===o?"1-3 分钟":"10"===m?h?"9-11 分钟":"1-3 分钟":h?"12-14 分钟":"3-5 分钟","sora-2-pro"===o&&h&&" (高清模式)"]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"审查说明："}),"官方审查涉及以下阶段："]}),(0,t.jsxs)("ul",{className:"list-disc list-inside ml-2 mt-1 space-y-1",children:[(0,t.jsx)("li",{children:"提交的图片中是否涉及真人（非常像真人的也不行）"}),(0,t.jsx)("li",{children:"提示词内容是否违规（暴力、色情、版权、活着的名人）"}),(0,t.jsx)("li",{children:"生成结果审查是否合格（这也是大家经常看到的生成了90%多后失败的原因）"})]})]})]})]})}),k&&(0,t.jsxs)("div",{className:"bg-white/10 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-white font-medium",children:"任务状态"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("SUCCESS"===k.status?"bg-green-500/20 text-green-300":"FAILURE"===k.status?"bg-red-500/20 text-red-300":"IN_PROGRESS"===k.status?"bg-blue-500/20 text-blue-300":"bg-gray-500/20 text-gray-300"),children:["NOT_START"===k.status&&"未开始","IN_PROGRESS"===k.status&&"正在执行","SUCCESS"===k.status&&"执行完成","FAILURE"===k.status&&"失败"]}),("SUCCESS"===k.status||"FAILURE"===k.status)&&(0,t.jsx)("button",{onClick:()=>{S(null),y(null),C(""),localStorage.removeItem("current_task_id"),L.current&&(clearInterval(L.current),L.current=null)},className:"px-2 py-1 bg-gray-500/20 text-gray-300 rounded text-xs hover:bg-gray-500/30 transition-colors",children:"清除"})]})]}),_&&(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-white/80 mb-1",children:[(0,t.jsx)("span",{children:"进度"}),(0,t.jsx)("span",{children:_})]}),(0,t.jsx)("div",{className:"w-full bg-white/20 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:_}})})]}),k.fail_reason&&(0,t.jsx)("p",{className:"text-red-300 text-sm mt-2",children:k.fail_reason}),(0,t.jsxs)("p",{className:"text-white/60 text-sm",children:["任务ID: ",k.task_id]})]}),(0,t.jsx)("button",{onClick:B,disabled:p,className:"w-full py-4 px-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-medium rounded-lg hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:p?(0,t.jsxs)("div",{className:"flex items-center justify-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white mr-3"}),(null==k?void 0:k.status)==="IN_PROGRESS"?"生成中...":(null==k?void 0:k.status)==="NOT_START"?"等待开始...":"提交中..."]}):"生成视频"}),j&&(0,t.jsxs)("div",{className:"bg-white/10 rounded-lg p-6",children:[(0,t.jsx)("h3",{className:"text-white font-medium mb-4",children:"生成的视频"}),(0,t.jsx)("video",{src:j,controls:!0,className:"w-full rounded-lg",children:"您的浏览器不支持视频播放。"}),(0,t.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,t.jsx)("a",{href:j,download:!0,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"下载视频"}),(0,t.jsx)("button",{onClick:()=>navigator.clipboard.writeText(j),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"复制链接"})]})]})]})]})})]})}}]);